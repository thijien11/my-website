<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>United Against Floods - Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ===== RESET & BASE STYLES ===== */
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --secondary: #34a853;
            --accent: #ea4335;
            --warning: #fbbc05;
            --light: #f8f9fa;
            --dark: #202124;
            --gray: #5f6368;
            --light-gray: #e8eaed;
            --light-bg: #f5f7fa;
            --light-text: #5f6368;
            --border-color: #e8eaed;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
            --border-radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        /* ===== LOGIN SCREEN ===== */
        .login-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 20px;
        }

        .login-container {
            background: white;
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 400px;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* ===== DASHBOARD HEADER ===== */
        .dashboard-header {
            background: white;
            padding: 0 25px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
            width: 250px;
            background: white;
            border-right: 1px solid var(--light-gray);
            height: calc(100vh - 70px);
            position: fixed;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 999;
        }

        /* ===== MAIN CONTENT ===== */
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 30px;
            background: #f5f7fa;
            min-height: calc(100vh - 70px);
        }

        /* ===== CONTENT CARDS ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-top: 4px solid var(--primary);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .stat-card.donation { border-top-color: var(--secondary); }
        .stat-card.volunteer { border-top-color: var(--primary); }
        .stat-card.project { border-top-color: var(--warning); }
        .stat-card.support { border-top-color: #673ab7; }

        /* ===== BUTTONS ===== */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            transition: var(--transition);
            font-size: 0.95rem;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26, 115, 232, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--gray);
            border: 1px solid var(--light-gray);
            padding: 12px 24px;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-size: 0.95rem;
        }

        .btn-secondary:hover {
            background: rgba(26, 115, 232, 0.05);
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-success {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-danger {
            background: var(--accent);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        /* ===== AI ANALYTICS SPECIFIC STYLES ===== */
        .analytics-dashboard {
            animation: fadeIn 0.5s ease;
        }
        
        .metric-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .metric-small {
            background: white;
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
        }
        
        .metric-small > div:first-child {
            font-size: 0.8rem;
            color: var(--light-text);
            margin-bottom: 5px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { transform: translateX(30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ===== TOAST NOTIFICATION ===== */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--dark);
            color: white;
            padding: 16px 24px;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transform: translateY(20px);
            transition: var(--transition);
            z-index: 2000;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 400px;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success { background: var(--secondary); }
        .toast.error { background: var(--accent); }
        .toast.warning { background: var(--warning); }
        .toast.info { background: var(--primary); }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ===== KEEP ALL YOUR EXISTING STYLES BELOW ===== */
        /* (I've condensed the CSS for brevity, but keep all your original styles) */
        .login-header { text-align: center; margin-bottom: 30px; }
        .login-logo { width: 80px; height: 80px; margin: 0 auto 15px; display: block; border-radius: 50%; background: var(--light); padding: 15px; }
        .login-header h2 { color: var(--primary); margin-bottom: 5px; }
        .login-header p { color: var(--gray); font-size: 0.9rem; }
        .login-form .form-group { margin-bottom: 20px; }
        .login-form label { display: block; margin-bottom: 8px; color: var(--gray); font-weight: 500; font-size: 0.9rem; }
        .login-form input { width: 100%; padding: 12px 15px; border: 2px solid var(--light-gray); border-radius: var(--border-radius); font-size: 16px; transition: var(--transition); }
        .login-form input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1); }
        .btn-login { width: 100%; padding: 14px; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; border: none; border-radius: var(--border-radius); font-size: 16px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: var(--transition); }
        .btn-login:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(26, 115, 232, 0.3); }
        .login-footer { margin-top: 20px; text-align: center; color: var(--gray); font-size: 0.85rem; }
        .header-left { display: flex; align-items: center; gap: 15px; }
        .menu-toggle { background: none; border: none; font-size: 24px; color: var(--primary); cursor: pointer; padding: 8px; border-radius: 4px; transition: var(--transition); }
        .menu-toggle:hover { background: rgba(26, 115, 232, 0.1); }
        .dashboard-header h1 { font-size: 1.4rem; color: var(--primary); }
        .header-right { display: flex; align-items: center; gap: 20px; }
        .notification-bell { position: relative; cursor: pointer; padding: 8px; border-radius: 50%; transition: var(--transition); }
        .notification-bell:hover { background: rgba(26, 115, 232, 0.1); }
        .notification-count { position: absolute; top: -5px; right: -5px; background: var(--accent); color: white; font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; min-width: 18px; text-align: center; font-weight: 600; }
        .user-profile { display: flex; align-items: center; gap: 10px; cursor: pointer; position: relative; padding: 8px 12px; border-radius: var(--border-radius); transition: var(--transition); }
        .user-profile:hover { background: rgba(26, 115, 232, 0.1); }
        .user-profile img { width: 36px; height: 36px; border-radius: 50%; border: 2px solid var(--primary); object-fit: cover; }
        .profile-dropdown { position: absolute; top: 100%; right: 0; background: white; min-width: 200px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15); border-radius: var(--border-radius); overflow: hidden; display: none; z-index: 1000; border: 1px solid var(--light-gray); }
        .user-profile:hover .profile-dropdown { display: block; }
        .profile-dropdown a { display: flex; align-items: center; gap: 10px; padding: 12px 15px; color: var(--gray); text-decoration: none; transition: var(--transition); font-size: 0.95rem; }
        .profile-dropdown a:hover { background: rgba(26, 115, 232, 0.1); color: var(--primary); }
        .profile-dropdown .divider { height: 1px; background: var(--light-gray); margin: 5px 0; }
        .dashboard-container { display: flex; margin-top: 70px; min-height: calc(100vh - 70px); }
        .sidebar-header { padding: 25px; border-bottom: 1px solid var(--light-gray); background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; }
        .sidebar-header h3 { font-size: 1.2rem; font-weight: 600; }
        .sidebar-nav ul { list-style: none; padding: 15px 0; }
        .sidebar-nav li a { display: flex; align-items: center; gap: 12px; padding: 15px 25px; color: var(--gray); text-decoration: none; transition: var(--transition); position: relative; font-size: 0.95rem; }
        .sidebar-nav li a:hover { background: rgba(26, 115, 232, 0.05); color: var(--primary); }
        .sidebar-nav li a.active { background: rgba(26, 115, 232, 0.1); color: var(--primary); border-left: 4px solid var(--primary); font-weight: 500; }
        .nav-badge { margin-left: auto; background: var(--accent); color: white; font-size: 0.75rem; padding: 3px 8px; border-radius: 10px; min-width: 20px; text-align: center; font-weight: 600; }
        .sidebar-footer { padding: 20px; border-top: 1px solid var(--light-gray); margin-top: auto; }
        .back-to-site { display: flex; align-items: center; gap: 10px; color: var(--gray); text-decoration: none; padding: 12px; border-radius: var(--border-radius); transition: var(--transition); font-size: 0.95rem; background: var(--light); }
        .back-to-site:hover { background: rgba(26, 115, 232, 0.1); color: var(--primary); }
        .content-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid var(--light-gray); }
        .content-header h2 { color: var(--dark); font-size: 1.8rem; font-weight: 600; }
        .header-actions { display: flex; gap: 15px; align-items: center; }
        .btn-refresh { background: white; border: 1px solid var(--light-gray); padding: 10px; border-radius: var(--border-radius); cursor: pointer; transition: var(--transition); color: var(--gray); }
        .btn-refresh:hover { background: rgba(26, 115, 232, 0.1); border-color: var(--primary); color: var(--primary); }
        .date-selector input { padding: 10px 15px; border: 1px solid var(--light-gray); border-radius: var(--border-radius); font-size: 14px; color: var(--gray); }
        .stat-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .stat-header h3 { font-size: 1.1rem; color: var(--gray); font-weight: 500; }
        .stat-icon { font-size: 24px; color: var(--primary); background: rgba(26, 115, 232, 0.1); padding: 12px; border-radius: 10px; }
        .stat-value { font-size: 2.2rem; font-weight: 700; color: var(--dark); margin-bottom: 10px; line-height: 1; }
        .stat-label { color: var(--gray); font-size: 0.95rem; margin-bottom: 10px; }
        .stat-change { display: inline-flex; align-items: center; gap: 5px; padding: 5px 10px; border-radius: 20px; font-size: 0.85rem; font-weight: 500; }
        .stat-change.positive { background: rgba(52, 168, 83, 0.1); color: var(--secondary); }
        .stat-change.negative { background: rgba(234, 67, 53, 0.1); color: var(--accent); }
        .table-container { background: white; border-radius: var(--border-radius); overflow: hidden; box-shadow: var(--shadow); margin-bottom: 30px; }
        .data-table { width: 100%; border-collapse: collapse; }
        .data-table th { background: #f8f9fa; padding: 18px 20px; text-align: left; font-weight: 600; color: var(--dark); border-bottom: 2px solid var(--light-gray); font-size: 0.95rem; }
        .data-table td { padding: 16px 20px; border-bottom: 1px solid var(--light-gray); color: var(--gray); font-size: 0.95rem; }
        .data-table tr:hover { background: rgba(26, 115, 232, 0.02); }
        .btn-edit { background: rgba(26, 115, 232, 0.1); color: var(--primary); border: 1px solid rgba(26, 115, 232, 0.2); padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85rem; transition: var(--transition); }
        .btn-edit:hover { background: rgba(26, 115, 232, 0.2); }
        .btn-delete { background: rgba(234, 67, 53, 0.1); color: var(--accent); border: 1px solid rgba(234, 67, 53, 0.2); padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85rem; transition: var(--transition); }
        .btn-delete:hover { background: rgba(234, 67, 53, 0.2); }
        .form-container { background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow); margin-bottom: 30px; }
        .form-group { margin-bottom: 25px; }
        .form-group label { display: block; margin-bottom: 8px; color: var(--dark); font-weight: 500; font-size: 0.95rem; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px 15px; border: 2px solid var(--light-gray); border-radius: var(--border-radius); font-size: 0.95rem; transition: var(--transition); font-family: inherit; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1); }
        .form-group textarea { min-height: 120px; resize: vertical; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .badge { display: inline-block; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 500; }
        .badge-success { background: rgba(52, 168, 83, 0.1); color: var(--secondary); }
        .badge-warning { background: rgba(251, 188, 5, 0.1); color: var(--warning); }
        .badge-danger { background: rgba(234, 67, 53, 0.1); color: var(--accent); }
        .badge-info { background: rgba(26, 115, 232, 0.1); color: var(--primary); }
        .chart-container { background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow); margin-bottom: 30px; }
        .chart-container h3 { margin-bottom: 20px; color: var(--dark); font-size: 1.2rem; }
        .modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 2000; opacity: 0; visibility: hidden; transition: var(--transition); }
        .modal.show { opacity: 1; visibility: visible; }
        .modal-content { background: white; border-radius: var(--border-radius); padding: 30px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .modal-header h3 { color: var(--dark); font-size: 1.3rem; }
        .modal-close { background: none; border: none; font-size: 24px; color: var(--gray); cursor: pointer; padding: 5px; transition: var(--transition); }
        .modal-close:hover { color: var(--accent); transform: rotate(90deg); }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">
                    <i class="material-icons" style="font-size: 40px; color: var(--primary);">water_damage</i>
                </div>
                <h2>United Against Floods</h2>
                <p>Admin Dashboard Login</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required placeholder="Enter username">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required placeholder="Enter password">
                </div>
                <button type="submit" class="btn-login">
                    <i class="material-icons">login</i> Login
                </button>
                <div class="login-footer">
                    <p>Default: admin / admin123</p>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Dashboard (hidden until login) -->
    <div class="dashboard-main" id="dashboardMain" style="display: none;">
        <!-- Top Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="material-icons">menu</i>
                </button>
                <h1>Admin Dashboard</h1>
            </div>
            <div class="header-right">
                <div class="notification-bell" onclick="showNotifications()">
                    <i class="material-icons">notifications</i>
                    <span class="notification-count" id="notificationCount">3</span>
                </div>
                <div class="user-profile" id="userProfile">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=1a73e8&color=fff&bold=true" alt="Admin">
                    <span id="userName">Administrator</span>
                    <i class="material-icons">arrow_drop_down</i>
                    <div class="profile-dropdown">
                        <a href="#" onclick="showProfileModal()"><i class="material-icons">person</i> Profile</a>
                        <a href="#" onclick="loadSettings()"><i class="material-icons">settings</i> Settings</a>
                        <div class="divider"></div>
                        <a href="#" id="logoutBtn"><i class="material-icons">logout</i> Logout</a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Container -->
        <div class="dashboard-container">
            <!-- Sidebar Navigation -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h3><i class="material-icons" style="vertical-align: middle; margin-right: 8px;">dashboard</i> Navigation</h3>
                </div>
                <nav class="sidebar-nav">
                    <ul>
                        <li><a href="#" data-view="overview" class="active">
                            <i class="material-icons">dashboard</i>
                            <span>Dashboard Overview</span>
                            <span class="nav-badge" id="overviewBadge">5</span>
                        </a></li>
                        
                        <li><a href="#" data-view="content">
                            <i class="material-icons">article</i>
                            <span>Content Management</span>
                        </a></li>
                        
                        <li><a href="#" data-view="donations">
                            <i class="material-icons">volunteer_activism</i>
                            <span>Donation Management</span>
                            <span class="nav-badge" id="donationBadge">12</span>
                        </a></li>
                        
                        <li><a href="#" data-view="volunteers">
                            <i class="material-icons">group</i>
                            <span>Volunteer Management</span>
                            <span class="nav-badge" id="volunteerBadge">8</span>
                        </a></li>
                        
                        <li><a href="#" data-view="team">
                            <i class="material-icons">people</i>
                            <span>Team Management</span>
                        </a></li>
                        
                        <li><a href="#" data-view="gallery">
                            <i class="material-icons">photo_library</i>
                            <span>Gallery Management</span>
                        </a></li>
                        
                        <li><a href="#" data-view="analytics">
                            <i class="material-icons">insights</i>
                            <span>Analytics & Reports</span>
                        </a></li>
                        
                        <li><a href="#" data-view="settings">
                            <i class="material-icons">settings</i>
                            <span>System Settings</span>
                        </a></li>
                    </ul>
                    
                    <div class="sidebar-footer">
                        <a href="/home.html" class="back-to-site">
                            <i class="material-icons">home</i>
                            <span>Back to Main Site</span>
                        </a>
                    </div>
                </nav>
            </aside>

            <!-- Main Content Area -->
            <main class="main-content" id="mainContent">
                <div class="content-header">
                    <h2 id="contentTitle">Dashboard Overview</h2>
                    <div class="header-actions">
                        <button class="btn-refresh" id="refreshBtn" onclick="refreshDashboard()">
                            <i class="material-icons">refresh</i>
                        </button>
                        <div class="date-selector">
                            <input type="date" id="dateFilter" onchange="filterByDate()">
                        </div>
                    </div>
                </div>
                
                <div class="content-body" id="contentBody">
                    <!-- Dynamic content loads here -->
                    <div id="dynamicContent">
                        <!-- Default overview content will load here -->
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="material-icons" id="toastIcon">info</i>
        <span id="toastMessage"></span>
    </div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Admin Profile</h3>
                <button class="modal-close" onclick="closeModal('profileModal')">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <form id="profileForm">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="profileName" value="Administrator">
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="profileEmail" value="admin@unitedagainstfloods.org">
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <input type="text" id="profileRole" value="Super Admin" disabled>
                </div>
                <div class="form-group">
                    <label>Last Login</label>
                    <input type="text" id="lastLogin" value="Just now" disabled>
                </div>
                <div style="margin-top: 30px; display: flex; gap: 10px;">
                    <button type="submit" class="btn-primary">Save Changes</button>
                    <button type="button" class="btn-secondary" onclick="closeModal('profileModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ===== AI ANALYTICS MODEL =====
        class DashboardAnalyticsAI {
            constructor() {
                this.collectedData = {
                    pageViews: JSON.parse(localStorage.getItem('analytics_page_views')) || [],
                    userActions: JSON.parse(localStorage.getItem('analytics_user_actions')) || [],
                    performanceMetrics: JSON.parse(localStorage.getItem('analytics_performance')) || [],
                    userSessions: JSON.parse(localStorage.getItem('analytics_sessions')) || []
                };
                
                this.recommendations = [];
                this.anomalies = [];
                this.predictions = {};
                
                this.config = {
                    anomalyThreshold: 3,
                    predictionDays: 7,
                    minDataPoints: 10,
                    analysisInterval: 30000,
                    autoReportInterval: 3600000
                };
            }
            
            init() {
                console.log('AI Analytics Model Initialized');
                this.collectInitialMetrics();
                this.setupPeriodicAnalysis();
                this.setupEventTracking();
                setTimeout(() => this.generateReport(), 5000);
                return this;
            }
            
            collectInitialMetrics() {
                const metrics = {
                    timestamp: new Date().toISOString(),
                    pageLoadTime: performance.timing.loadEventEnd - performance.timing.navigationStart,
                    domLoadTime: performance.timing.domContentLoadedEventEnd - performance.timing.navigationStart,
                    firstPaint: performance.getEntriesByType('paint').find(p => p.name === 'first-paint')?.startTime || 0,
                    firstContentfulPaint: performance.getEntriesByType('paint').find(p => p.name === 'first-contentful-paint')?.startTime || 0,
                    memoryUsage: performance.memory ? performance.memory.usedJSHeapSize : 0,
                    interactiveTime: performance.timing.domInteractive - performance.timing.navigationStart,
                    totalBlockingTime: this.calculateBlockingTime()
                };
                
                this.collectedData.performanceMetrics.push(metrics);
                this.saveData();
                this.analyzePerformance(metrics);
            }
            
            calculateBlockingTime() {
                const longTasks = performance.getEntriesByType('longtask');
                return longTasks.reduce((total, task) => total + task.duration, 0);
            }
            
            setupEventTracking() {
                this.trackPageView();
                this.trackUserInteractions();
                this.trackFormSubmissions();
                this.trackButtonClicks();
                this.trackNavigation();
            }
            
            trackPageView() {
                const pageView = {
                    timestamp: new Date().toISOString(),
                    page: window.location.pathname,
                    referrer: document.referrer,
                    userAgent: navigator.userAgent,
                    screenSize: `${window.screen.width}x${window.screen.height}`,
                    viewportSize: `${window.innerWidth}x${window.innerHeight}`
                };
                
                this.collectedData.pageViews.push(pageView);
                this.saveData();
            }
            
            trackUserInteractions() {
                document.addEventListener('click', (e) => {
                    const target = e.target;
                    
                    if (target.tagName === 'BUTTON' || 
                        target.tagName === 'A' || 
                        target.closest('button') || 
                        target.closest('a')) {
                        
                        const action = {
                            timestamp: new Date().toISOString(),
                            type: 'click',
                            element: target.tagName,
                            text: target.textContent?.trim() || target.innerText?.trim() || '',
                            className: target.className,
                            id: target.id,
                            href: target.href || '',
                            page: window.location.pathname,
                            x: e.clientX,
                            y: e.clientY
                        };
                        
                        this.collectedData.userActions.push(action);
                        this.saveData();
                    }
                });
                
                document.addEventListener('submit', (e) => {
                    const form = e.target;
                    const action = {
                        timestamp: new Date().toISOString(),
                        type: 'form_submit',
                        formId: form.id,
                        formClass: form.className,
                        page: window.location.pathname,
                        fields: Array.from(form.elements)
                            .filter(el => el.name)
                            .map(el => ({
                                name: el.name,
                                type: el.type,
                                value: el.value ? 'filled' : 'empty'
                            }))
                    };
                    
                    this.collectedData.userActions.push(action);
                    this.saveData();
                });
            }
            
            trackFormSubmissions() {
                const forms = document.querySelectorAll('form');
                forms.forEach(form => {
                    form.addEventListener('submit', (e) => {
                        this.logFormSubmission(form);
                    });
                });
            }
            
            trackButtonClicks() {
                const importantButtons = [
                    '#refreshBtn', '.btn-primary', '.btn-secondary', 
                    '.btn-success', '.btn-danger', '.btn-warning'
                ];
                
                importantButtons.forEach(selector => {
                    document.querySelectorAll(selector).forEach(button => {
                        button.addEventListener('click', (e) => {
                            this.logButtonClick(button, selector);
                        });
                    });
                });
            }
            
            trackNavigation() {
                document.querySelectorAll('.sidebar-nav a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        const view = link.getAttribute('data-view');
                        if (view) {
                            this.logNavigation(view, 'sidebar');
                        }
                    });
                });
            }
            
            logFormSubmission(form) {
                const action = {
                    timestamp: new Date().toISOString(),
                    type: 'form_submission',
                    formId: form.id || 'unknown',
                    page: window.location.pathname,
                    fieldCount: form.elements.length
                };
                
                this.collectedData.userActions.push(action);
                this.saveData();
            }
            
            logButtonClick(button, selector) {
                const action = {
                    timestamp: new Date().toISOString(),
                    type: 'button_click',
                    buttonText: button.textContent?.trim() || '',
                    selector: selector,
                    page: window.location.pathname
                };
                
                this.collectedData.userActions.push(action);
                this.saveData();
            }
            
            logNavigation(view, source) {
                const action = {
                    timestamp: new Date().toISOString(),
                    type: 'navigation',
                    view: view,
                    source: source,
                    page: window.location.pathname
                };
                
                this.collectedData.userActions.push(action);
                this.saveData();
            }
            
            setupPeriodicAnalysis() {
                setInterval(() => {
                    this.analyzeAll();
                }, this.config.analysisInterval);
                
                setInterval(() => {
                    this.generateReport();
                }, this.config.autoReportInterval);
            }
            
            analyzeAll() {
                if (this.collectedData.performanceMetrics.length >= this.config.minDataPoints) {
                    this.analyzePerformanceTrends();
                    this.analyzeUserBehavior();
                    this.detectAnomalies();
                    this.generatePredictions();
                    this.generateRecommendations();
                }
            }
            
            analyzePerformance(metrics) {
                const thresholds = {
                    pageLoadTime: 3000,
                    domLoadTime: 2000,
                    firstContentfulPaint: 1500,
                    totalBlockingTime: 300
                };
                
                const issues = [];
                
                if (metrics.pageLoadTime > thresholds.pageLoadTime) {
                    issues.push(`Page load time is ${metrics.pageLoadTime}ms (threshold: ${thresholds.pageLoadTime}ms)`);
                }
                
                if (metrics.domLoadTime > thresholds.domLoadTime) {
                    issues.push(`DOM load time is ${metrics.domLoadTime}ms (threshold: ${thresholds.domLoadTime}ms)`);
                }
                
                if (metrics.firstContentfulPaint > thresholds.firstContentfulPaint) {
                    issues.push(`First contentful paint is ${metrics.firstContentfulPaint}ms (threshold: ${thresholds.firstContentfulPaint}ms)`);
                }
                
                if (metrics.totalBlockingTime > thresholds.totalBlockingTime) {
                    issues.push(`Total blocking time is ${metrics.totalBlockingTime}ms (threshold: ${thresholds.totalBlockingTime}ms)`);
                }
                
                if (issues.length > 0) {
                    this.anomalies.push({
                        timestamp: new Date().toISOString(),
                        type: 'performance_issue',
                        issues: issues,
                        severity: this.calculateSeverity(issues.length)
                    });
                    
                    if (issues.length >= 2) {
                        this.showPerformanceWarning(issues);
                    }
                }
            }
            
            calculateSeverity(issueCount) {
                if (issueCount >= 4) return 'critical';
                if (issueCount >= 2) return 'high';
                if (issueCount >= 1) return 'medium';
                return 'low';
            }
            
            showPerformanceWarning(issues) {
                if (!document.getElementById('performanceWarning')) {
                    const warning = document.createElement('div');
                    warning.id = 'performanceWarning';
                    warning.style.cssText = `
                        position: fixed;
                        top: 80px;
                        right: 20px;
                        background: var(--warning);
                        color: white;
                        padding: 15px 20px;
                        border-radius: var(--border-radius);
                        box-shadow: var(--shadow);
                        z-index: 2001;
                        max-width: 400px;
                        animation: slideInRight 0.3s ease;
                    `;
                    
                    warning.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <i class="material-icons" style="color: white;">warning</i>
                            <strong>Performance Alert</strong>
                            <button onclick="this.parentElement.parentElement.remove()" style="margin-left: auto; background: none; border: none; color: white; cursor: pointer;">
                                <i class="material-icons">close</i>
                            </button>
                        </div>
                        <div style="font-size: 0.9rem;">
                            ${issues.slice(0, 2).map(issue => `<div>â€¢ ${issue}</div>`).join('')}
                            ${issues.length > 2 ? `<div>... and ${issues.length - 2} more issues</div>` : ''}
                        </div>
                    `;
                    
                    document.body.appendChild(warning);
                    
                    setTimeout(() => {
                        if (warning.parentNode) {
                            warning.remove();
                        }
                    }, 10000);
                }
            }
            
            analyzePerformanceTrends() {
                const metrics = this.collectedData.performanceMetrics;
                if (metrics.length < 2) return;
                
                const recentMetrics = metrics.slice(-10);
                
                const averages = {
                    pageLoadTime: this.calculateAverage(recentMetrics.map(m => m.pageLoadTime)),
                    domLoadTime: this.calculateAverage(recentMetrics.map(m => m.domLoadTime)),
                    firstContentfulPaint: this.calculateAverage(recentMetrics.map(m => m.firstContentfulPaint)),
                    totalBlockingTime: this.calculateAverage(recentMetrics.map(m => m.totalBlockingTime))
                };
                
                const trends = {
                    pageLoadTime: this.calculateTrend(metrics.map(m => m.pageLoadTime)),
                    domLoadTime: this.calculateTrend(metrics.map(m => m.domLoadTime)),
                    firstContentfulPaint: this.calculateTrend(metrics.map(m => m.firstContentfulPaint)),
                    totalBlockingTime: this.calculateTrend(metrics.map(m => m.totalBlockingTime))
                };
                
                Object.entries(trends).forEach(([metric, trend]) => {
                    if (trend > 0.1) {
                        this.recommendations.push({
                            type: 'performance',
                            metric: metric,
                            issue: `Increasing ${metric.replace(/([A-Z])/g, ' $1').toLowerCase()} trend detected`,
                            suggestion: `Consider optimizing ${metric.replace(/([A-Z])/g, ' $1').toLowerCase()}`,
                            priority: 'medium'
                        });
                    }
                });
            }
            
            analyzeUserBehavior() {
                const actions = this.collectedData.userActions;
                if (actions.length === 0) return;
                
                const actionTypes = actions.reduce((acc, action) => {
                    acc[action.type] = (acc[action.type] || 0) + 1;
                    return acc;
                }, {});
                
                const buttonClicks = actions.filter(a => a.type === 'button_click');
                const popularButtons = this.findPopularElements(buttonClicks, 'buttonText');
                
                const navigationClicks = actions.filter(a => a.type === 'navigation');
                const popularViews = this.findPopularElements(navigationClicks, 'view');
                
                this.generateBehaviorInsights(actionTypes, popularButtons, popularViews);
            }
            
            findPopularElements(actions, property) {
                const counts = {};
                actions.forEach(action => {
                    const value = action[property];
                    if (value) {
                        counts[value] = (counts[value] || 0) + 1;
                    }
                });
                
                return Object.entries(counts)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5)
                    .map(([value, count]) => ({ value, count }));
            }
            
            generateBehaviorInsights(actionTypes, popularButtons, popularViews) {
                if (popularViews.length > 0) {
                    const mostPopularView = popularViews[0];
                    if (mostPopularView.count > 10) {
                        this.recommendations.push({
                            type: 'user_behavior',
                            insight: `"${mostPopularView.value}" is the most visited section (${mostPopularView.count} visits)`,
                            suggestion: 'Consider adding more features or content to this section',
                            priority: 'low'
                        });
                    }
                }
                
                const totalClicks = Object.values(actionTypes).reduce((a, b) => a + b, 0);
                Object.entries(actionTypes).forEach(([type, count]) => {
                    const percentage = (count / totalClicks) * 100;
                    if (percentage < 5 && count > 0) {
                        this.recommendations.push({
                            type: 'user_behavior',
                            insight: `${type.replace('_', ' ')} actions are underutilized (${percentage.toFixed(1)}% of total)`,
                            suggestion: 'Consider making this feature more prominent or easier to access',
                            priority: 'low'
                        });
                    }
                });
            }
            
            detectAnomalies() {
                this.detectPerformanceAnomalies();
                this.detectUsageAnomalies();
            }
            
            detectPerformanceAnomalies() {
                const metrics = this.collectedData.performanceMetrics;
                if (metrics.length < 5) return;
                
                const recentMetrics = metrics.slice(-20);
                const pageLoadTimes = recentMetrics.map(m => m.pageLoadTime);
                
                const mean = this.calculateMean(pageLoadTimes);
                const stdDev = this.calculateStdDev(pageLoadTimes, mean);
                
                recentMetrics.forEach((metric, index) => {
                    const zScore = Math.abs((metric.pageLoadTime - mean) / stdDev);
                    if (zScore > this.config.anomalyThreshold) {
                        this.anomalies.push({
                            timestamp: metric.timestamp,
                            type: 'performance_anomaly',
                            metric: 'pageLoadTime',
                            value: metric.pageLoadTime,
                            mean: mean,
                            stdDev: stdDev,
                            zScore: zScore,
                            severity: 'high'
                        });
                    }
                });
            }
            
            detectUsageAnomalies() {
                const actions = this.collectedData.userActions;
                if (actions.length < 10) return;
                
                const hourlyActions = {};
                actions.forEach(action => {
                    const hour = new Date(action.timestamp).getHours();
                    hourlyActions[hour] = (hourlyActions[hour] || 0) + 1;
                });
                
                Object.entries(hourlyActions).forEach(([hour, count]) => {
                    const hourNum = parseInt(hour);
                    if ((hourNum < 6 || hourNum > 22) && count > 5) {
                        this.anomalies.push({
                            timestamp: new Date().toISOString(),
                            type: 'usage_anomaly',
                            hour: hourNum,
                            count: count,
                            insight: `Unusual activity detected at ${hourNum}:00 (${count} actions)`,
                            severity: 'low'
                        });
                    }
                });
            }
            
            generatePredictions() {
                if (this.collectedData.pageViews.length >= 7) {
                    this.predictTraffic();
                }
                
                if (this.collectedData.userActions.length >= 20) {
                    this.predictUserBehavior();
                }
            }
            
            predictTraffic() {
                const pageViews = this.collectedData.pageViews;
                const dailyViews = {};
                
                pageViews.forEach(view => {
                    const date = view.timestamp.split('T')[0];
                    dailyViews[date] = (dailyViews[date] || 0) + 1;
                });
                
                const viewCounts = Object.values(dailyViews);
                if (viewCounts.length >= 3) {
                    const prediction = this.linearRegressionPrediction(viewCounts, this.config.predictionDays);
                    
                    this.predictions.traffic = {
                        next7Days: prediction,
                        currentAvg: this.calculateAverage(viewCounts.slice(-7)),
                        trend: this.calculateTrend(viewCounts),
                        confidence: Math.min(0.95, viewCounts.length / 100)
                    };
                }
            }
            
            predictUserBehavior() {
                const actions = this.collectedData.userActions;
                const actionTypes = actions.reduce((acc, action) => {
                    acc[action.type] = (acc[action.type] || 0) + 1;
                    return acc;
                }, {});
                
                const totalActions = actions.length;
                const dailyActions = totalActions / Math.max(1, (new Date(actions[actions.length - 1].timestamp) - new Date(actions[0].timestamp)) / (1000 * 60 * 60 * 24));
                
                this.predictions.userBehavior = {
                    dailyActions: dailyActions,
                    actionDistribution: actionTypes,
                    mostLikelyNextAction: this.predictNextAction(actions),
                    engagementScore: this.calculateEngagementScore(actions)
                };
            }
            
            predictNextAction(actions) {
                if (actions.length < 5) return null;
                
                const recentActions = actions.slice(-5).map(a => a.type);
                const transitions = {};
                
                for (let i = 0; i < recentActions.length - 1; i++) {
                    const from = recentActions[i];
                    const to = recentActions[i + 1];
                    if (!transitions[from]) transitions[from] = {};
                    transitions[from][to] = (transitions[from][to] || 0) + 1;
                }
                
                const lastAction = recentActions[recentActions.length - 1];
                if (transitions[lastAction]) {
                    const possibleNext = Object.entries(transitions[lastAction]);
                    if (possibleNext.length > 0) {
                        const mostLikely = possibleNext.sort((a, b) => b[1] - a[1])[0];
                        return {
                            action: mostLikely[0],
                            probability: mostLikely[1] / Object.values(transitions[lastAction]).reduce((a, b) => a + b, 0)
                        };
                    }
                }
                
                return null;
            }
            
            calculateEngagementScore(actions) {
                if (actions.length === 0) return 0;
                
                const last24Hours = actions.filter(a => 
                    new Date() - new Date(a.timestamp) < 24 * 60 * 60 * 1000
                ).length;
                
                const uniqueActions = new Set(actions.map(a => a.type)).size;
                const sessionCount = this.calculateSessions(actions);
                
                const score = (last24Hours * 0.4) + (uniqueActions * 0.3) + (sessionCount * 0.3);
                return Math.min(100, score * 10);
            }
            
            calculateSessions(actions) {
                if (actions.length === 0) return 0;
                
                let sessions = 1;
                let lastTime = new Date(actions[0].timestamp);
                
                for (let i = 1; i < actions.length; i++) {
                    const currentTime = new Date(actions[i].timestamp);
                    const diffMinutes = (currentTime - lastTime) / (1000 * 60);
                    
                    if (diffMinutes > 30) {
                        sessions++;
                    }
                    
                    lastTime = currentTime;
                }
                
                return sessions;
            }
            
            generateRecommendations() {
                this.recommendations = this.recommendations.filter(r => 
                    new Date() - new Date(r.timestamp || new Date().toISOString()) < 24 * 60 * 60 * 1000
                );
            }
            
            generateReport() {
                const report = {
                    timestamp: new Date().toISOString(),
                    summary: this.generateSummary(),
                    performance: this.analyzePerformanceReport(),
                    userBehavior: this.analyzeUserBehaviorReport(),
                    anomalies: this.anomalies.slice(-10),
                    predictions: this.predictions,
                    recommendations: this.recommendations.slice(-5),
                    dataPoints: {
                        pageViews: this.collectedData.pageViews.length,
                        userActions: this.collectedData.userActions.length,
                        performanceMetrics: this.collectedData.performanceMetrics.length
                    }
                };
                
                this.saveReport(report);
                this.showReportNotification(report);
                
                return report;
            }
            
            generateSummary() {
                const metrics = this.collectedData.performanceMetrics;
                const latestMetric = metrics[metrics.length - 1];
                const actions = this.collectedData.userActions;
                
                return {
                    overallHealth: this.calculateHealthScore(),
                    performanceScore: latestMetric ? this.calculatePerformanceScore(latestMetric) : 0,
                    engagementScore: this.calculateEngagementScore(actions),
                    activeUsers: this.calculateActiveUsers(),
                    issuesCount: this.anomalies.filter(a => a.severity === 'high' || a.severity === 'critical').length
                };
            }
            
            calculateHealthScore() {
                let score = 100;
                
                this.anomalies.forEach(anomaly => {
                    if (anomaly.severity === 'critical') score -= 20;
                    else if (anomaly.severity === 'high') score -= 10;
                    else if (anomaly.severity === 'medium') score -= 5;
                });
                
                const metrics = this.collectedData.performanceMetrics;
                if (metrics.length > 0) {
                    const latest = metrics[metrics.length - 1];
                    if (latest.pageLoadTime > 3000) score -= 10;
                    if (latest.totalBlockingTime > 300) score -= 10;
                }
                
                return Math.max(0, score);
            }
            
            calculatePerformanceScore(metric) {
                let score = 100;
                
                if (metric.pageLoadTime > 4000) score -= 30;
                else if (metric.pageLoadTime > 3000) score -= 20;
                else if (metric.pageLoadTime > 2000) score -= 10;
                
                if (metric.firstContentfulPaint > 2000) score -= 20;
                else if (metric.firstContentfulPaint > 1500) score -= 10;
                
                return Math.max(0, score);
            }
            
            calculateActiveUsers() {
                const actions = this.collectedData.userActions;
                if (actions.length === 0) return 0;
                
                const last24Hours = actions.filter(a => 
                    new Date() - new Date(a.timestamp) < 24 * 60 * 60 * 1000
                );
                
                return Math.ceil(this.calculateSessions(last24Hours) * 1.2);
            }
            
            analyzePerformanceReport() {
                const metrics = this.collectedData.performanceMetrics;
                if (metrics.length === 0) return null;
                
                const recentMetrics = metrics.slice(-10);
                
                return {
                    averageLoadTime: this.calculateAverage(recentMetrics.map(m => m.pageLoadTime)),
                    averageFP: this.calculateAverage(recentMetrics.map(m => m.firstContentfulPaint)),
                    averageFCP: this.calculateAverage(recentMetrics.map(m => m.firstContentfulPaint)),
                    averageTBT: this.calculateAverage(recentMetrics.map(m => m.totalBlockingTime)),
                    trend: this.calculateTrend(metrics.map(m => m.pageLoadTime)),
                    issues: this.anomalies.filter(a => a.type.includes('performance')).length
                };
            }
            
            analyzeUserBehaviorReport() {
                const actions = this.collectedData.userActions;
                if (actions.length === 0) return null;
                
                const last24Hours = actions.filter(a => 
                    new Date() - new Date(a.timestamp) < 24 * 60 * 60 * 1000
                );
                
                return {
                    totalActions: actions.length,
                    actionsLast24h: last24Hours.length,
                    popularActions: this.findPopularElements(actions, 'type').slice(0, 3),
                    averageSessionLength: this.calculateAverageSessionLength(actions),
                    bounceRate: this.calculateBounceRate(actions)
                };
            }
            
            calculateAverageSessionLength(actions) {
                const sessions = this.groupIntoSessions(actions);
                if (sessions.length === 0) return 0;
                
                const totalLength = sessions.reduce((total, session) => {
                    if (session.actions.length < 2) return total;
                    const first = new Date(session.actions[0].timestamp);
                    const last = new Date(session.actions[session.actions.length - 1].timestamp);
                    return total + (last - first);
                }, 0);
                
                return totalLength / (sessions.length * 1000);
            }
            
            calculateBounceRate(actions) {
                const sessions = this.groupIntoSessions(actions);
                if (sessions.length === 0) return 0;
                
                const bouncedSessions = sessions.filter(s => s.actions.length <= 2).length;
                return (bouncedSessions / sessions.length) * 100;
            }
            
            groupIntoSessions(actions) {
                if (actions.length === 0) return [];
                
                actions.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
                
                const sessions = [];
                let currentSession = [actions[0]];
                
                for (let i = 1; i < actions.length; i++) {
                    const prevTime = new Date(actions[i - 1].timestamp);
                    const currTime = new Date(actions[i].timestamp);
                    const diffMinutes = (currTime - prevTime) / (1000 * 60);
                    
                    if (diffMinutes > 30) {
                        sessions.push({ actions: [...currentSession] });
                        currentSession = [actions[i]];
                    } else {
                        currentSession.push(actions[i]);
                    }
                }
                
                if (currentSession.length > 0) {
                    sessions.push({ actions: currentSession });
                }
                
                return sessions;
            }
            
            saveReport(report) {
                const reports = JSON.parse(localStorage.getItem('analytics_reports')) || [];
                reports.push(report);
                
                if (reports.length > 50) {
                    reports.shift();
                }
                
                localStorage.setItem('analytics_reports', JSON.stringify(reports));
                
                localStorage.setItem('analytics_summary', JSON.stringify({
                    lastUpdated: new Date().toISOString(),
                    healthScore: report.summary.overallHealth,
                    activeUsers: report.summary.activeUsers,
                    performanceScore: report.summary.performanceScore
                }));
            }
            
            showReportNotification(report) {
                if (report.summary.overallHealth < 70) {
                    this.showAlert('Dashboard Health Alert', 
                        `Dashboard health score is ${report.summary.overallHealth}. Check analytics for details.`,
                        'warning');
                }
            }
            
            showAlert(title, message, type = 'info') {
                const alertId = 'analyticsAlert-' + Date.now();
                const alert = document.createElement('div');
                alert.id = alertId;
                alert.style.cssText = `
                    position: fixed;
                    top: 100px;
                    right: 20px;
                    background: ${type === 'warning' ? 'var(--warning)' : type === 'error' ? 'var(--accent)' : 'var(--primary)'};
                    color: white;
                    padding: 15px 20px;
                    border-radius: var(--border-radius);
                    box-shadow: var(--shadow);
                    z-index: 2001;
                    max-width: 400px;
                    animation: slideInRight 0.3s ease;
                `;
                
                alert.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <i class="material-icons" style="color: white;">${type === 'warning' ? 'warning' : 'info'}</i>
                        <strong>${title}</strong>
                        <button onclick="document.getElementById('${alertId}').remove()" style="margin-left: auto; background: none; border: none; color: white; cursor: pointer;">
                            <i class="material-icons">close</i>
                        </button>
                    </div>
                    <div style="font-size: 0.9rem;">${message}</div>
                `;
                
                document.body.appendChild(alert);
                
                setTimeout(() => {
                    if (alert.parentNode) {
                        alert.remove();
                    }
                }, 10000);
            }
            
            saveData() {
                localStorage.setItem('analytics_page_views', JSON.stringify(this.collectedData.pageViews));
                localStorage.setItem('analytics_user_actions', JSON.stringify(this.collectedData.userActions));
                localStorage.setItem('analytics_performance', JSON.stringify(this.collectedData.performanceMetrics));
                localStorage.setItem('analytics_sessions', JSON.stringify(this.collectedData.userSessions));
                this.trimData();
            }
            
            trimData() {
                const maxRecords = 1000;
                
                Object.keys(this.collectedData).forEach(key => {
                    if (this.collectedData[key].length > maxRecords) {
                        this.collectedData[key] = this.collectedData[key].slice(-maxRecords);
                    }
                });
            }
            
            calculateAverage(values) {
                if (!values.length) return 0;
                return values.reduce((a, b) => a + b, 0) / values.length;
            }
            
            calculateMean(values) {
                return this.calculateAverage(values);
            }
            
            calculateStdDev(values, mean) {
                if (!values.length) return 0;
                const squaredDiffs = values.map(value => Math.pow(value - mean, 2));
                return Math.sqrt(squaredDiffs.reduce((a, b) => a + b, 0) / values.length);
            }
            
            calculateTrend(values) {
                if (values.length < 2) return 0;
                
                const x = Array.from({ length: values.length }, (_, i) => i);
                const y = values;
                
                const n = x.length;
                const sumX = x.reduce((a, b) => a + b, 0);
                const sumY = y.reduce((a, b) => a + b, 0);
                const sumXY = x.reduce((sum, xi, i) => sum + xi * y[i], 0);
                const sumX2 = x.reduce((sum, xi) => sum + xi * xi, 0);
                
                const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
                return slope;
            }
            
            linearRegressionPrediction(values, daysAhead) {
                if (values.length < 2) return Array(daysAhead).fill(values[0] || 0);
                
                const x = Array.from({ length: values.length }, (_, i) => i);
                const y = values;
                
                const n = x.length;
                const sumX = x.reduce((a, b) => a + b, 0);
                const sumY = y.reduce((a, b) => a + b, 0);
                const sumXY = x.reduce((sum, xi, i) => sum + xi * y[i], 0);
                const sumX2 = x.reduce((sum, xi) => sum + xi * xi, 0);
                
                const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
                const intercept = (sumY - slope * sumX) / n;
                
                const predictions = [];
                for (let i = 0; i < daysAhead; i++) {
                    predictions.push(slope * (values.length + i) + intercept);
                }
                
                return predictions.map(p => Math.max(0, Math.round(p)));
            }
            
            createAnalyticsDashboard() {
                const report = this.generateReport();
                
                return `
                    <div class="analytics-dashboard" style="background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                            <h2 style="color: var(--dark);">
                                <i class="material-icons" style="vertical-align: middle; margin-right: 10px;">insights</i>
                                AI Analytics Dashboard
                            </h2>
                            <button class="btn-primary" onclick="window.aiAnalytics.generateReport(); this.innerHTML='<i class=\\'material-icons\\'>refresh</i> Report Generated!'; setTimeout(() => this.innerHTML='<i class=\\'material-icons\\'>refresh</i> Generate Report', 2000)">
                                <i class="material-icons">refresh</i>
                                Generate Report
                            </button>
                        </div>
                        
                        <!-- Health Overview -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div class="metric-card" style="background: linear-gradient(135deg, var(--primary), #667eea); color: white; padding: 20px; border-radius: var(--border-radius);">
                                <div style="font-size: 0.9rem; opacity: 0.9;">Overall Health Score</div>
                                <div style="font-size: 3rem; font-weight: bold; margin: 10px 0;">${report.summary.overallHealth}</div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="flex: 1; height: 6px; background: rgba(255,255,255,0.3); border-radius: 3px;">
                                        <div style="width: ${report.summary.overallHealth}%; height: 100%; background: white; border-radius: 3px;"></div>
                                    </div>
                                    <div>${report.summary.overallHealth >= 80 ? 'Excellent' : report.summary.overallHealth >= 60 ? 'Good' : 'Needs Attention'}</div>
                                </div>
                            </div>
                            
                            <div class="metric-card" style="background: white; border: 1px solid var(--border-color); padding: 20px; border-radius: var(--border-radius);">
                                <div style="font-size: 0.9rem; color: var(--light-text);">Active Users (24h)</div>
                                <div style="font-size: 3rem; font-weight: bold; margin: 10px 0; color: var(--dark);">${report.summary.activeUsers}</div>
                                <div style="color: var(--light-text);">
                                    <i class="material-icons" style="vertical-align: middle; font-size: 1rem;">people</i>
                                    Estimated unique users
                                </div>
                            </div>
                            
                            <div class="metric-card" style="background: white; border: 1px solid var(--border-color); padding: 20px; border-radius: var(--border-radius);">
                                <div style="font-size: 0.9rem; color: var(--light-text);">Performance Score</div>
                                <div style="font-size: 3rem; font-weight: bold; margin: 10px 0; color: var(--dark);">${report.summary.performanceScore}</div>
                                <div style="color: ${report.summary.performanceScore >= 80 ? 'var(--success)' : report.summary.performanceScore >= 60 ? 'var(--warning)' : 'var(--accent)'};">
                                    <i class="material-icons" style="vertical-align: middle; font-size: 1rem;">${report.summary.performanceScore >= 80 ? 'check_circle' : report.summary.performanceScore >= 60 ? 'warning' : 'error'}</i>
                                    ${report.summary.performanceScore >= 80 ? 'Optimal' : report.summary.performanceScore >= 60 ? 'Acceptable' : 'Poor'}
                                </div>
                            </div>
                            
                            <div class="metric-card" style="background: white; border: 1px solid var(--border-color); padding: 20px; border-radius: var(--border-radius);">
                                <div style="font-size: 0.9rem; color: var(--light-text);">Critical Issues</div>
                                <div style="font-size: 3rem; font-weight: bold; margin: 10px 0; color: ${report.summary.issuesCount > 0 ? 'var(--accent)' : 'var(--success)'};">${report.summary.issuesCount}</div>
                                <div style="color: var(--light-text);">
                                    <i class="material-icons" style="vertical-align: middle; font-size: 1rem;">${report.summary.issuesCount > 0 ? 'error' : 'check_circle'}</i>
                                    ${report.summary.issuesCount > 0 ? 'Needs attention' : 'All systems normal'}
                                </div>
                            </div>
                        </div>
                        
                        <!-- Performance Metrics -->
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: var(--dark); margin-bottom: 20px;">
                                <i class="material-icons" style="vertical-align: middle; margin-right: 10px;">speed</i>
                                Performance Metrics
                            </h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                ${report.performance ? `
                                    <div class="metric-small">
                                        <div>Avg Load Time</div>
                                        <div style="font-size: 1.5rem; font-weight: bold; color: ${report.performance.averageLoadTime > 3000 ? 'var(--accent)' : report.performance.averageLoadTime > 2000 ? 'var(--warning)' : 'var(--success)'};">${Math.round(report.performance.averageLoadTime)}ms</div>
                                    </div>
                                    <div class="metric-small">
                                        <div>First Contentful Paint</div>
                                        <div style="font-size: 1.5rem; font-weight: bold; color: ${report.performance.averageFCP > 1500 ? 'var(--accent)' : report.performance.averageFCP > 1000 ? 'var(--warning)' : 'var(--success)'};">${Math.round(report.performance.averageFCP)}ms</div>
                                    </div>
                                    <div class="metric-small">
                                        <div>Total Blocking Time</div>
                                        <div style="font-size: 1.5rem; font-weight: bold; color: ${report.performance.averageTBT > 300 ? 'var(--accent)' : report.performance.averageTBT > 200 ? 'var(--warning)' : 'var(--success)'};">${Math.round(report.performance.averageTBT)}ms</div>
                                    </div>
                                    <div class="metric-small">
                                        <div>Performance Trend</div>
                                        <div style="font-size: 1.5rem; font-weight: bold; color: ${report.performance.trend > 0 ? 'var(--accent)' : 'var(--success)'};">${report.performance.trend > 0 ? 'â†‘' : 'â†“'} ${Math.abs(report.performance.trend * 100).toFixed(1)}%</div>
                                    </div>
                                ` : '<div>No performance data yet</div>'}
                            </div>
                        </div>
                        
                        <!-- User Behavior -->
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: var(--dark); margin-bottom: 20px;">
                                <i class="material-icons" style="vertical-align: middle; margin-right: 10px;">psychology</i>
                                User Behavior Insights
                            </h3>
                            <div style="background: var(--light-bg); padding: 20px; border-radius: var(--border-radius);">
                                ${report.userBehavior ? `
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                        <div>
                                            <div style="font-weight: bold; margin-bottom: 10px;">Popular Actions</div>
                                            <div style="font-size: 0.9rem;">
                                                ${report.userBehavior.popularActions.map(action => `
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                        <span>${action.value.replace('_', ' ')}</span>
                                                        <span style="color: var(--primary);">${action.count}</span>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                        <div>
                                            <div style="font-weight: bold; margin-bottom: 10px;">Session Statistics</div>
                                            <div style="font-size: 0.9rem;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                    <span>Total Actions (24h)</span>
                                                    <span style="color: var(--primary);">${report.userBehavior.actionsLast24h}</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                    <span>Avg Session Length</span>
                                                    <span style="color: var(--primary);">${Math.round(report.userBehavior.averageSessionLength)}s</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between;">
                                                    <span>Bounce Rate</span>
                                                    <span style="color: ${report.userBehavior.bounceRate > 50 ? 'var(--accent)' : 'var(--success)'};">${report.userBehavior.bounceRate.toFixed(1)}%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ` : '<div>No user behavior data yet</div>'}
                            </div>
                        </div>
                        
                        <!-- AI Recommendations -->
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: var(--dark); margin-bottom: 20px;">
                                <i class="material-icons" style="vertical-align: middle; margin-right: 10px;">auto_awesome</i>
                                AI Recommendations
                            </h3>
                            <div style="display: grid; gap: 15px;">
                                ${report.recommendations.length > 0 ? report.recommendations.map(rec => `
                                    <div style="background: ${rec.priority === 'high' ? 'var(--light-accent)' : rec.priority === 'medium' ? 'var(--light-warning)' : 'var(--light-bg)'}; padding: 15px; border-radius: var(--border-radius); border-left: 4px solid ${rec.priority === 'high' ? 'var(--accent)' : rec.priority === 'medium' ? 'var(--warning)' : 'var(--primary)'};">
                                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                            <div style="font-weight: bold;">${rec.type.replace('_', ' ').toUpperCase()}</div>
                                            <span style="background: ${rec.priority === 'high' ? 'var(--accent)' : rec.priority === 'medium' ? 'var(--warning)' : 'var(--primary)'}; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">${rec.priority}</span>
                                        </div>
                                        <div style="color: var(--dark); margin-bottom: 5px;">${rec.insight || rec.issue}</div>
                                        <div style="color: var(--light-text); font-size: 0.9rem;">
                                            <i class="material-icons" style="vertical-align: middle; font-size: 1rem;">lightbulb</i>
                                            ${rec.suggestion}
                                        </div>
                                    </div>
                                `).join('') : `
                                    <div style="text-align: center; padding: 40px; color: var(--light-text);">
                                        <i class="material-icons" style="font-size: 3rem; margin-bottom: 10px;">check_circle</i>
                                        <div>No recommendations at this time. All systems are operating optimally.</div>
                                    </div>
                                `}
                            </div>
                        </div>
                        
                        <!-- Predictions -->
                        ${report.predictions && Object.keys(report.predictions).length > 0 ? `
                            <div style="margin-bottom: 30px;">
                                <h3 style="color: var(--dark); margin-bottom: 20px;">
                                    <i class="material-icons" style="vertical-align: middle; margin-right: 10px;">trending_up</i>
                                    AI Predictions
                                </h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                                    ${report.predictions.traffic ? `
                                        <div style="background: var(--light-bg); padding: 20px; border-radius: var(--border-radius);">
                                            <div style="font-weight: bold; margin-bottom: 15px;">Traffic Forecast (7 days)</div>
                                            <div style="margin-bottom: 10px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                    <span>Current Average:</span>
                                                    <span>${Math.round(report.predictions.traffic.currentAvg)} views/day</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between;">
                                                    <span>Trend:</span>
                                                    <span style="color: ${report.predictions.traffic.trend > 0 ? 'var(--success)' : 'var(--accent)'};">${(report.predictions.traffic.trend * 100).toFixed(1)}%</span>
                                                </div>
                                            </div>
                                            <div style="font-size: 0.9rem; color: var(--light-text);">
                                                Next 7 days: ${report.predictions.traffic.next7Days.join(', ')}
                                            </div>
                                        </div>
                                    ` : ''}
                                    
                                    ${report.predictions.userBehavior ? `
                                        <div style="background: var(--light-bg); padding: 20px; border-radius: var(--border-radius);">
                                            <div style="font-weight: bold; margin-bottom: 15px;">User Engagement</div>
                                            <div style="margin-bottom: 10px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                    <span>Engagement Score:</span>
                                                    <span style="color: ${report.predictions.userBehavior.engagementScore >= 70 ? 'var(--success)' : report.predictions.userBehavior.engagementScore >= 40 ? 'var(--warning)' : 'var(--accent)'};">${Math.round(report.predictions.userBehavior.engagementScore)}/100</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between;">
                                                    <span>Daily Actions:</span>
                                                    <span>${Math.round(report.predictions.userBehavior.dailyActions)}</span>
                                                </div>
                                            </div>
                                            ${report.predictions.userBehavior.mostLikelyNextAction ? `
                                                <div style="font-size: 0.9rem; color: var(--light-text);">
                                                    Most likely next action: ${report.predictions.userBehavior.mostLikelyNextAction.action}
                                                    (${(report.predictions.userBehavior.mostLikelyNextAction.probability * 100).toFixed(0)}% confidence)
                                                </div>
                                            ` : ''}
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        ` : ''}
                        
                        <!-- Anomalies -->
                        ${report.anomalies && report.anomalies.length > 0 ? `
                            <div>
                                <h3 style="color: var(--dark); margin-bottom: 20px;">
                                    <i class="material-icons" style="vertical-align: middle; margin-right: 10px;">warning</i>
                                    Recent Anomalies
                                </h3>
                                <div style="display: grid; gap: 10px; max-height: 300px; overflow-y: auto;">
                                    ${report.anomalies.slice(-5).map(anomaly => `
                                        <div style="background: ${anomaly.severity === 'critical' ? 'var(--light-accent)' : anomaly.severity === 'high' ? 'var(--light-warning)' : 'var(--light-bg)'}; padding: 12px 15px; border-radius: var(--border-radius); border-left: 4px solid ${anomaly.severity === 'critical' ? 'var(--accent)' : anomaly.severity === 'high' ? 'var(--warning)' : 'var(--primary)'};">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                                <div style="font-weight: bold; color: ${anomaly.severity === 'critical' ? 'var(--accent)' : anomaly.severity === 'high' ? 'var(--warning)' : 'var(--dark)'};">${anomaly.type.replace('_', ' ').toUpperCase()}</div>
                                                <div style="font-size: 0.8rem; color: var(--light-text);">${new Date(anomaly.timestamp).toLocaleTimeString()}</div>
                                            </div>
                                            <div style="color: var(--dark); font-size: 0.9rem; margin-bottom: 5px;">${anomaly.insight || anomaly.issue || 'Anomaly detected'}</div>
                                            ${anomaly.metric ? `
                                                <div style="font-size: 0.8rem; color: var(--light-text);">
                                                    ${anomaly.metric}: ${anomaly.value} (Z-score: ${anomaly.zScore ? anomaly.zScore.toFixed(2) : 'N/A'})
                                                </div>
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                        
                        <!-- Data Summary -->
                        <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="color: var(--light-text); font-size: 0.9rem;">
                                    <i class="material-icons" style="vertical-align: middle; font-size: 1rem;">data_usage</i>
                                    Data collected: 
                                    ${report.dataPoints.pageViews} page views, 
                                    ${report.dataPoints.userActions} user actions,
                                    ${report.dataPoints.performanceMetrics} performance metrics
                                </div>
                                <div style="color: var(--light-text); font-size: 0.9rem;">
                                    Last updated: ${new Date(report.timestamp).toLocaleTimeString()}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            exportData() {
                const data = {
                    timestamp: new Date().toISOString(),
                    analyticsData: this.collectedData,
                    report: this.generateReport(),
                    config: this.config
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `analytics-export-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            clearData() {
                if (confirm('Are you sure you want to clear all analytics data? This action cannot be undone.')) {
                    this.collectedData = {
                        pageViews: [],
                        userActions: [],
                        performanceMetrics: [],
                        userSessions: []
                    };
                    this.recommendations = [];
                    this.anomalies = [];
                    this.predictions = {};
                    
                    localStorage.removeItem('analytics_page_views');
                    localStorage.removeItem('analytics_user_actions');
                    localStorage.removeItem('analytics_performance');
                    localStorage.removeItem('analytics_sessions');
                    localStorage.removeItem('analytics_reports');
                    localStorage.removeItem('analytics_summary');
                    
                    showToast('All analytics data has been cleared.', 'info');
                }
            }
            
            getDashboardHTML() {
                return this.createAnalyticsDashboard();
            }
        }

        // ===== DASHBOARD DATA =====
        const dashboardData = {
            stats: {
                totalDonations: 12450,
                activeVolunteers: 48,
                ongoingProjects: 7,
                newSupporters: 127,
                pendingDonations: 5,
                pendingVolunteers: 3,
                pendingRequests: 8
            },
            
            donations: [
                { id: 1, donor: "John Smith", email: "john@email.com", amount: 250, type: "one-time", status: "completed", date: "2024-03-15", method: "card" },
                { id: 2, donor: "Sarah Johnson", email: "sarah@email.com", amount: 100, type: "monthly", status: "pending", date: "2024-03-14", method: "paypal" },
                { id: 3, donor: "Michael Brown", email: "michael@email.com", amount: 500, type: "one-time", status: "completed", date: "2024-03-13", method: "bank" },
                { id: 4, donor: "Emily Davis", email: "emily@email.com", amount: 50, type: "monthly", status: "completed", date: "2024-03-12", method: "card" },
                { id: 5, donor: "Robert Wilson", email: "robert@email.com", amount: 1000, type: "one-time", status: "completed", date: "2024-03-11", method: "card" }
            ],
            
            volunteers: [
                { id: 1, name: "David Wilson", email: "david@email.com", phone: "+254 712 345 678", location: "Nairobi", status: "active", skills: "First Aid, Logistics", date: "2024-03-10" },
                { id: 2, name: "Lisa Anderson", email: "lisa@email.com", phone: "+254 723 456 789", location: "Mombasa", status: "pending", skills: "Medical, Counseling", date: "2024-03-09" },
                { id: 3, name: "Robert Taylor", email: "robert@email.com", phone: "+254 734 567 890", location: "Kisumu", status: "active", skills: "Engineering, Construction", date: "2024-03-08" },
                { id: 4, name: "Maria Garcia", email: "maria@email.com", phone: "+254 745 678 901", location: "Nakuru", status: "active", skills: "Teaching, Child Care", date: "2024-03-07" }
            ],
            
            team: [
                { id: 1, name: "TEBUOM GATWECH", role: "Founder & CEO", bio: "Leads with vision and compassion, driving our mission forward with over 10 years of experience.", image: "../images/TEM.jpg", skills: ["Leadership", "Strategy", "Fundraising"] },
                { id: 2, name: "THIJIEN CHIKOT", role: "Program Manager", bio: "Coordinates projects with care, ensuring effective support reaches those who need it most.", image: "../images/thijien.jpg", skills: ["Project Management", "Logistics", "Coordination"] },
                { id: 3, name: "GATWECH BOTH", role: "Community Outreach", bio: "Builds strong relationships with local communities, spreading hope and opportunities.", image: "../images/gatwech.jpg", skills: ["Community Engagement", "Communication", "Partnership"] },
                { id: 4, name: "WICHNOK JR", role: "Volunteer Coordinator", bio: "Mobilizes and supports our amazing volunteers, matching skills with community needs.", image: "../images/wichnok.jpg", skills: ["Volunteer Management", "Training", "Motivation"] }
            ],
            
            notifications: [
                { id: 1, message: "New donation received: $500 from Michael Brown", time: "2 hours ago", type: "donation", read: false },
                { id: 2, message: "3 new volunteer applications pending review", time: "5 hours ago", type: "volunteer", read: false },
                { id: 3, message: "Project 'Flood Relief Nairobi' requires attention", time: "1 day ago", type: "project", read: false },
                { id: 4, message: "System backup completed successfully", time: "2 days ago", type: "system", read: true }
            ]
        };

        // ===== GLOBAL STATE =====
        let currentView = 'overview';
        let isSidebarOpen = true;
        let charts = {};
        let aiAnalytics = new DashboardAnalyticsAI().init();

        // ===== LOGIN FUNCTIONALITY =====
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'admin' && password === 'admin123') {
                showToast('Login successful! Redirecting...', 'success');
                
                setTimeout(() => {
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('dashboardMain').style.display = 'block';
                    loadView('overview');
                    updateNotificationBadges();
                    showToast('Welcome to the Admin Dashboard!', 'success');
                }, 1000);
            } else {
                showToast('Invalid credentials. Try admin/admin123', 'error');
            }
        });

        // ===== NAVIGATION =====
        document.querySelectorAll('.sidebar-nav a[data-view]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const view = this.getAttribute('data-view');
                
                document.querySelectorAll('.sidebar-nav a').forEach(a => a.classList.remove('active'));
                this.classList.add('active');
                
                loadView(view);
            });
        });

        function loadView(view) {
            currentView = view;
            const titleMap = {
                'overview': 'Dashboard Overview',
                'content': 'Content Management',
                'donations': 'Donation Management',
                'volunteers': 'Volunteer Management',
                'team': 'Team Management',
                'gallery': 'Gallery Management',
                'analytics': 'Analytics & Reports',
                'settings': 'System Settings'
            };
            
            document.getElementById('contentTitle').textContent = titleMap[view] || 'Dashboard';
            
            switch(view) {
                case 'overview':
                    loadOverview();
                    break;
                case 'donations':
                    loadDonations();
                    break;
                case 'volunteers':
                    loadVolunteers();
                    break;
                case 'team':
                    loadTeam();
                    break;
                case 'analytics':
                    loadAnalytics();
                    break;
                case 'content':
                    loadContentManagement();
                    break;
                case 'gallery':
                    loadGallery();
                    break;
                case 'settings':
                    loadSettings();
                    break;
            }
        }

        // ===== VIEW LOADERS =====
        function loadOverview() {
            const content = `
                <div class="stats-grid">
                    <div class="stat-card donation">
                        <div class="stat-header">
                            <h3>Total Donations</h3>
                            <div class="stat-icon">
                                <i class="material-icons">volunteer_activism</i>
                            </div>
                        </div>
                        <div class="stat-value">$${dashboardData.stats.totalDonations.toLocaleString()}</div>
                        <div class="stat-label">This month</div>
                        <span class="stat-change positive">
                            <i class="material-icons">trending_up</i> 12% from last month
                        </span>
                    </div>
                    
                    <div class="stat-card volunteer">
                        <div class="stat-header">
                            <h3>Active Volunteers</h3>
                            <div class="stat-icon">
                                <i class="material-icons">group</i>
                            </div>
                        </div>
                        <div class="stat-value">${dashboardData.stats.activeVolunteers}</div>
                        <div class="stat-label">Currently active</div>
                        <span class="stat-change positive">
                            <i class="material-icons">trending_up</i> 8 new this week
                        </span>
                    </div>
                    
                    <div class="stat-card project">
                        <div class="stat-header">
                            <h3>Ongoing Projects</h3>
                            <div class="stat-icon">
                                <i class="material-icons">construction</i>
                            </div>
                        </div>
                        <div class="stat-value">${dashboardData.stats.ongoingProjects}</div>
                        <div class="stat-label">Active initiatives</div>
                        <span class="stat-change warning">
                            <i class="material-icons">info</i> 2 need attention
                        </span>
                    </div>
                    
                    <div class="stat-card support">
                        <div class="stat-header">
                            <h3>New Supporters</h3>
                            <div class="stat-icon">
                                <i class="material-icons">person_add</i>
                            </div>
                        </div>
                        <div class="stat-value">${dashboardData.stats.newSupporters}</div>
                        <div class="stat-label">Last 30 days</div>
                        <span class="stat-change positive">
                            <i class="material-icons">trending_up</i> 24% growth
                        </span>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3>Donation Trends</h3>
                    <canvas id="donationChart"></canvas>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                    <div class="table-container">
                        <h3 style="padding: 20px 20px 0; font-size: 1.1rem; color: var(--dark);">Recent Donations</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Donor</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${dashboardData.donations.slice(0, 5).map(donation => `
                                    <tr>
                                        <td>${donation.donor}</td>
                                        <td style="color: var(--secondary); font-weight: 600;">$${donation.amount}</td>
                                        <td><span class="badge ${donation.status === 'completed' ? 'badge-success' : 'badge-warning'}">${donation.status}</span></td>
                                        <td>${donation.date}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        <div style="padding: 15px 20px; text-align: center; border-top: 1px solid var(--light-gray);">
                            <a href="#" onclick="loadView('donations')" style="color: var(--primary); text-decoration: none; font-weight: 500;">
                                View All Donations <i class="material-icons" style="vertical-align: middle; font-size: 16px;">arrow_forward</i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <h3 style="padding: 20px 20px 0; font-size: 1.1rem; color: var(--dark);">Recent Volunteers</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Location</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${dashboardData.volunteers.slice(0, 5).map(volunteer => `
                                    <tr>
                                        <td>${volunteer.name}</td>
                                        <td>${volunteer.location}</td>
                                        <td><span class="badge ${volunteer.status === 'active' ? 'badge-success' : 'badge-warning'}">${volunteer.status}</span></td>
                                        <td>${volunteer.date}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        <div style="padding: 15px 20px; text-align: center; border-top: 1px solid var(--light-gray);">
                            <a href="#" onclick="loadView('volunteers')" style="color: var(--primary); text-decoration: none; font-weight: 500;">
                                View All Volunteers <i class="material-icons" style="vertical-align: middle; font-size: 16px;">arrow_forward</i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <h3 style="padding: 20px 20px 0; font-size: 1.1rem; color: var(--dark);">Recent Notifications</h3>
                    <div style="padding: 20px;">
                        ${dashboardData.notifications.filter(n => !n.read).slice(0, 3).map(notification => `
                            <div style="padding: 12px 0; border-bottom: 1px solid var(--light-gray);">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <i class="material-icons" style="color: ${getNotificationColor(notification.type)};">${getNotificationIcon(notification.type)}</i>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 500;">${notification.message}</div>
                                        <div style="font-size: 0.85rem; color: var(--gray);">${notification.time}</div>
                                    </div>
                                    <button class="btn-edit" onclick="markAsRead(${notification.id})">Mark Read</button>
                                </div>
                            </div>
                        `).join('')}
                        <div style="text-align: center; padding-top: 15px;">
                            <button class="btn-secondary" onclick="showNotifications()">
                                <i class="material-icons">notifications</i> View All Notifications
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('dynamicContent').innerHTML = content;
            
            setTimeout(() => {
                initDonationChart();
            }, 100);
        }

        function loadDonations() {
            const content = `
                <div style="margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="color: var(--dark);">Donation Management</h3>
                    <button class="btn-primary" onclick="showAddDonationModal()">
                        <i class="material-icons">add</i> Add Donation
                    </button>
                </div>
                
                <div class="stats-grid" style="margin-bottom: 30px; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                    <div class="stat-card" style="border-top-color: var(--secondary);">
                        <div class="stat-value">$${dashboardData.stats.totalDonations.toLocaleString()}</div>
                        <div class="stat-label">Total Donations</div>
                    </div>
                    <div class="stat-card" style="border-top-color: var(--primary);">
                        <div class="stat-value">${dashboardData.donations.length}</div>
                        <div class="stat-label">All Transactions</div>
                    </div>
                    <div class="stat-card" style="border-top-color: var(--warning);">
                        <div class="stat-value">${dashboardData.stats.pendingDonations}</div>
                        <div class="stat-label">Pending</div>
                    </div>
                    <div class="stat-card" style="border-top-color: var(--accent);">
                        <div class="stat-value">${dashboardData.donations.filter(d => d.type === 'monthly').length}</div>
                        <div class="stat-label">Recurring</div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div style="padding: 20px; border-bottom: 1px solid var(--light-gray);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin-bottom: 5px; color: var(--dark);">All Donations</h3>
                                <p style="color: var(--gray); font-size: 0.9rem;">Manage and track all donation transactions</p>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <select style="padding: 8px 12px; border: 1px solid var(--light-gray); border-radius: var(--border-radius);">
                                    <option>Filter by Status</option>
                                    <option>Completed</option>
                                    <option>Pending</option>
                                    <option>Failed</option>
                                </select>
                                <input type="text" placeholder="Search donations..." style="padding: 8px 12px; border: 1px solid var(--light-gray); border-radius: var(--border-radius);">
                            </div>
                        </div>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Donor</th>
                                <th>Amount</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Method</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${dashboardData.donations.map(donation => `
                                <tr>
                                    <td>#${donation.id}</td>
                                    <td>
                                        <div style="font-weight: 500;">${donation.donor}</div>
                                        <div style="font-size: 0.85rem; color: var(--gray);">${donation.email}</div>
                                    </td>
                                    <td style="font-weight: 600; color: var(--secondary);">$${donation.amount}</td>
                                    <td><span class="badge ${donation.type === 'monthly' ? 'badge-info' : 'badge-success'}">${donation.type}</span></td>
                                    <td><span class="badge ${donation.status === 'completed' ? 'badge-success' : 'badge-warning'}">${donation.status}</span></td>
                                    <td>${donation.date}</td>
                                    <td>${donation.method}</td>
                                    <td>
                                        <button class="btn-edit" onclick="editDonation(${donation.id})">
                                            <i class="material-icons" style="font-size: 16px;">edit</i>
                                        </button>
                                        <button class="btn-delete" onclick="deleteDonation(${donation.id})">
                                            <i class="material-icons" style="font-size: 16px;">delete</i>
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div style="padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-top: 1px solid var(--light-gray);">
                        <div style="color: var(--gray); font-size: 0.9rem;">
                            Showing ${dashboardData.donations.length} of ${dashboardData.donations.length} donations
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <button class="btn-secondary" style="padding: 8px 12px;">Previous</button>
                            <button class="btn-secondary" style="padding: 8px 12px; background: var(--primary); color: white;">1</button>
                            <button class="btn-secondary" style="padding: 8px 12px;">2</button>
                            <button class="btn-secondary" style="padding: 8px 12px;">Next</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('dynamicContent').innerHTML = content;
        }

        function loadVolunteers() {
            const content = `
                <div style="margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="color: var(--dark);">Volunteer Management</h3>
                    <button class="btn-primary" onclick="showAddVolunteerModal()">
                        <i class="material-icons">person_add</i> Add Volunteer
                    </button>
                </div>
                
                <div class="table-container">
                    <div style="padding: 20px; border-bottom: 1px solid var(--light-gray);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin-bottom: 5px; color: var(--dark);">All Volunteers</h3>
                                <p style="color: var(--gray); font-size: 0.9rem;">Manage volunteer applications and information</p>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <select style="padding: 8px 12px; border: 1px solid var(--light-gray); border-radius: var(--border-radius);">
                                    <option>Filter by Status</option>
                                    <option>Active</option>
                                    <option>Pending</option>
                                    <option>Inactive</option>
                                </select>
                                <input type="text" placeholder="Search volunteers..." style="padding: 8px 12px; border: 1px solid var(--light-gray); border-radius: var(--border-radius);">
                            </div>
                        </div>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Contact</th>
                                <th>Location</th>
                                <th>Skills</th>
                                <th>Status</th>
                                <th>Join Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${dashboardData.volunteers.map(volunteer => `
                                <tr>
                                    <td>#${volunteer.id}</td>
                                    <td style="font-weight: 500;">${volunteer.name}</td>
                                    <td>
                                        <div>${volunteer.email}</div>
                                        <div style="font-size: 0.85rem; color: var(--gray);">${volunteer.phone}</div>
                                    </td>
                                    <td>${volunteer.location}</td>
                                    <td>
                                        <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                            ${volunteer.skills.split(', ').map(skill => `
                                                <span style="background: rgba(26, 115, 232, 0.1); color: var(--primary); padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">${skill}</span>
                                            `).join('')}
                                        </div>
                                    </td>
                                    <td><span class="badge ${volunteer.status === 'active' ? 'badge-success' : 'badge-warning'}">${volunteer.status}</span></td>
                                    <td>${volunteer.date}</td>
                                    <td>
                                        <button class="btn-edit" onclick="editVolunteer(${volunteer.id})">
                                            <i class="material-icons" style="font-size: 16px;">edit</i>
                                        </button>
                                        <button class="btn-delete" onclick="deleteVolunteer(${volunteer.id})">
                                            <i class="material-icons" style="font-size: 16px;">delete</i>
                                        </button>
                                        ${volunteer.status === 'pending' ? `
                                            <button class="btn-success" style="padding: 6px 12px; margin-left: 5px;" onclick="approveVolunteer(${volunteer.id})">
                                                <i class="material-icons" style="font-size: 16px;">check</i>
                                            </button>
                                        ` : ''}
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
            
            document.getElementById('dynamicContent').innerHTML = content;
        }

        function loadTeam() {
            const content = `
                <div style="margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="color: var(--dark);">Team Management</h3>
                    <button class="btn-primary" onclick="showAddTeamModal()">
                        <i class="material-icons">person_add</i> Add Team Member
                    </button>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px; margin-bottom: 40px;">
                    ${dashboardData.team.map(member => `
                        <div style="background: white; border-radius: var(--border-radius); overflow: hidden; box-shadow: var(--shadow);">
                            <div style="height: 150px; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); position: relative;">
                                <div style="position: absolute; bottom: -40px; left: 20px;">
                                    <img src="${member.image}" alt="${member.name}" style="width: 80px; height: 80px; border-radius: 50%; border: 4px solid white;">
                                </div>
                            </div>
                            <div style="padding: 50px 20px 20px;">
                                <h3 style="margin-bottom: 5px; color: var(--dark);">${member.name}</h3>
                                <div style="color: var(--primary); font-weight: 500; margin-bottom: 15px;">${member.role}</div>
                                <p style="color: var(--gray); margin-bottom: 20px; font-size: 0.95rem;">${member.bio}</p>
                                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px;">
                                    ${member.skills.map(skill => `
                                        <span style="background: rgba(26, 115, 232, 0.1); color: var(--primary); padding: 4px 10px; border-radius: 15px; font-size: 0.8rem;">${skill}</span>
                                    `).join('')}
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button class="btn-edit" style="flex: 1;" onclick="editTeamMember(${member.id})">
                                        <i class="material-icons" style="font-size: 16px;">edit</i> Edit
                                    </button>
                                    <button class="btn-delete" style="flex: 1;" onclick="deleteTeamMember(${member.id})">
                                        <i class="material-icons" style="font-size: 16px;">delete</i> Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.getElementById('dynamicContent').innerHTML = content;
        }

        function loadAnalytics() {
            const aiReport = aiAnalytics.generateReport();
            const aiDashboard = aiAnalytics.createAnalyticsDashboard();
            
            const content = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--dark);">Analytics & Reports</h3>
                    <p style="color: var(--gray);">Detailed insights and performance metrics with AI-powered analytics</p>
                </div>
                
                <!-- AI Analytics Dashboard -->
                <div style="margin-bottom: 30px;">
                    ${aiDashboard}
                </div>
                
                <!-- Legacy Charts Section -->
                <div class="stats-grid" style="margin-bottom: 30px;">
                    <div class="stat-card">
                        <div class="stat-value">$${(dashboardData.stats.totalDonations / 1000).toFixed(1)}k</div>
                        <div class="stat-label">Total Raised</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${dashboardData.stats.activeVolunteers + dashboardData.stats.pendingVolunteers}</div>
                        <div class="stat-label">Total Volunteers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${dashboardData.stats.newSupporters}</div>
                        <div class="stat-label">New Supporters (30d)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${aiReport.summary.overallHealth}</div>
                        <div class="stat-label">System Health Score</div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px; margin-bottom: 30px;">
                    <div class="chart-container">
                        <h3>Monthly Donation Trends</h3>
                        <canvas id="monthlyChart" height="250"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Donation Methods</h3>
                        <canvas id="methodChart" height="250"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3>Volunteer Distribution by Location</h3>
                    <canvas id="locationChart" height="200"></canvas>
                </div>
                
                <!-- Analytics Controls -->
                <div style="margin-top: 30px; text-align: center; display: flex; gap: 10px; justify-content: center;">
                    <button class="btn-primary" onclick="generateReport()">
                        <i class="material-icons">download</i> Download Full Report
                    </button>
                    <button class="btn-secondary" onclick="printAnalytics()">
                        <i class="material-icons">print</i> Print Analytics
                    </button>
                    <button class="btn-secondary" onclick="aiAnalytics.exportData()" style="background: var(--accent);">
                        <i class="material-icons">file_download</i> Export AI Data
                    </button>
                    <button class="btn-warning" onclick="aiAnalytics.clearData()">
                        <i class="material-icons">delete</i> Clear AI Data
                    </button>
                </div>
                
                <!-- Real-time AI Status -->
                <div style="margin-top: 30px; background: var(--light-bg); padding: 15px; border-radius: var(--border-radius); font-size: 0.9rem; color: var(--gray);">
                    <i class="material-icons" style="vertical-align: middle;">info</i>
                    AI Analytics is collecting data: ${aiAnalytics.collectedData.userActions.length} user actions, 
                    ${aiAnalytics.collectedData.performanceMetrics.length} performance metrics
                </div>
            `;
            
            document.getElementById('dynamicContent').innerHTML = content;
            
            setTimeout(() => {
                initAnalyticsCharts();
            }, 100);
        }

        function loadContentManagement() {
            const content = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--dark);">Content Management</h3>
                    <p style="color: var(--gray);">Manage website pages, blog posts, and announcements</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; margin-bottom: 40px;">
                    <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(26, 115, 232, 0.1); color: var(--primary); padding: 12px; border-radius: 10px;">
                                <i class="material-icons">article</i>
                            </div>
                            <div>
                                <div style="font-size: 1.5rem; font-weight: 700;">12</div>
                                <div style="color: var(--gray);">Blog Posts</div>
                            </div>
                        </div>
                        <button class="btn-primary" style="width: 100%;" onclick="manageContent('blog')">
                            <i class="material-icons">edit</i> Manage Blog
                        </button>
                    </div>
                    
                    <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(52, 168, 83, 0.1); color: var(--secondary); padding: 12px; border-radius: 10px;">
                                <i class="material-icons">campaign</i>
                            </div>
                            <div>
                                <div style="font-size: 1.5rem; font-weight: 700;">5</div>
                                <div style="color: var(--gray);">Announcements</div>
                            </div>
                        </div>
                        <button class="btn-primary" style="width: 100%;" onclick="manageContent('announcements')">
                            <i class="material-icons">edit</i> Manage Announcements
                        </button>
                    </div>
                    
                    <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(251, 188, 5, 0.1); color: var(--warning); padding: 12px; border-radius: 10px;">
                                <i class="material-icons">pages</i>
                            </div>
                            <div>
                                <div style="font-size: 1.5rem; font-weight: 700;">8</div>
                                <div style="color: var(--gray);">Pages</div>
                            </div>
                        </div>
                        <button class="btn-primary" style="width: 100%;" onclick="manageContent('pages')">
                            <i class="material-icons">edit</i> Manage Pages
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <div style="padding: 20px; border-bottom: 1px solid var(--light-gray);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin-bottom: 5px; color: var(--dark);">Recent Blog Posts</h3>
                                <p style="color: var(--gray); font-size: 0.9rem;">Latest published articles</p>
                            </div>
                            <button class="btn-primary" onclick="addNewPost()">
                                <i class="material-icons">add</i> New Post
                            </button>
                        </div>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Category</th>
                                <th>Status</th>
                                <th>Publish Date</th>
                                <th>Views</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Flood Preparedness Guide 2024</td>
                                <td>Tebuom Gatwech</td>
                                <td>Safety</td>
                                <td><span class="badge badge-success">Published</span></td>
                                <td>2024-03-10</td>
                                <td>1,245</td>
                                <td>
                                    <button class="btn-edit"><i class="material-icons" style="font-size: 16px;">edit</i></button>
                                    <button class="btn-delete"><i class="material-icons" style="font-size: 16px;">delete</i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Success Story: Nairobi Relief</td>
                                <td>Thijien Chikot</td>
                                <td>Stories</td>
                                <td><span class="badge badge-success">Published</span></td>
                                <td>2024-03-05</td>
                                <td>892</td>
                                <td>
                                    <button class="btn-edit"><i class="material-icons" style="font-size: 16px;">edit</i></button>
                                    <button class="btn-delete"><i class="material-icons" style="font-size: 16px;">delete</i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Volunteer Opportunities</td>
                                <td>Wichnok Jr</td>
                                <td>Volunteering</td>
                                <td><span class="badge badge-warning">Draft</span></td>
                                <td>2024-03-01</td>
                                <td>0</td>
                                <td>
                                    <button class="btn-edit"><i class="material-icons" style="font-size: 16px;">edit</i></button>
                                    <button class="btn-success"><i class="material-icons" style="font-size: 16px;">publish</i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
            
            document.getElementById('dynamicContent').innerHTML = content;
        }

        function loadGallery() {
            const content = `
                <div style="margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="color: var(--dark);">Gallery Management</h3>
                    <button class="btn-primary" onclick="showUploadModal()">
                        <i class="material-icons">add_photo_alternate</i> Upload Images
                    </button>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                        <button class="btn-secondary active" onclick="filterGallery('all')">All Photos</button>
                        <button class="btn-secondary" onclick="filterGallery('events')">Events</button>
                        <button class="btn-secondary" onclick="filterGallery('projects')">Projects</button>
                        <button class="btn-secondary" onclick="filterGallery('team')">Team</button>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;">
                        ${Array.from({length: 8}).map((_, i) => `
                            <div style="background: white; border-radius: var(--border-radius); overflow: hidden; box-shadow: var(--shadow);">
                                <div style="height: 150px; background: linear-gradient(135deg, #${Math.floor(Math.random()*16777215).toString(16).padStart(6,'0')}, #${Math.floor(Math.random()*16777215).toString(16).padStart(6,'0')});"></div>
                                <div style="padding: 15px;">
                                    <div style="font-weight: 500; margin-bottom: 10px;">Gallery Image ${i + 1}</div>
                                    <div style="display: flex; gap: 10px;">
                                        <button class="btn-edit" style="flex: 1;">
                                            <i class="material-icons" style="font-size: 16px;">edit</i>
                                        </button>
                                        <button class="btn-delete" style="flex: 1;">
                                            <i class="material-icons" style="font-size: 16px;">delete</i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('dynamicContent').innerHTML = content;
        }

        function loadSettings() {
            const content = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--dark);">System Settings</h3>
                    <p style="color: var(--gray);">Configure system preferences and options</p>
                </div>
                
                <div class="form-container">
                    <h3 style="margin-bottom: 20px; color: var(--dark);">General Settings</h3>
                    
                    <div class="form-group">
                        <label>Organization Name</label>
                        <input type="text" value="United Against Floods" placeholder="Enter organization name">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Contact Email</label>
                            <input type="email" value="contact@unitedagainstfloods.org" placeholder="Enter contact email">
                        </div>
                        <div class="form-group">
                            <label>Contact Phone</label>
                            <input type="tel" value="+254 700 123 456" placeholder="Enter contact phone">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Website URL</label>
                        <input type="url" value="https://unitedagainstfloods.org" placeholder="Enter website URL">
                    </div>
                    
                    <div class="form-group">
                        <label>Organization Description</label>
                        <textarea rows="4" placeholder="Enter organization description">A non-profit organization dedicated to flood prevention, relief, and community support across vulnerable regions.</textarea>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <button class="btn-primary">Save Settings</button>
                        <button class="btn-secondary" style="margin-left: 10px;">Reset to Default</button>
                    </div>
                </div>
                
                <div class="form-container">
                    <h3 style="margin-bottom: 20px; color: var(--dark);">Notification Settings</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                            <input type="checkbox" checked>
                            <span>Email notifications for new donations</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                            <input type="checkbox" checked>
                            <span>Email notifications for volunteer applications</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox">
                            <span>Weekly summary reports</span>
                        </label>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <button class="btn-primary">Update Notifications</button>
                    </div>
                </div>
                
                <div class="form-container">
                    <h3 style="margin-bottom: 20px; color: var(--dark);">Danger Zone</h3>
                    <p style="color: var(--gray); margin-bottom: 20px;">Be careful with these actions. They cannot be undone.</p>
                    
                    <div style="display: flex; gap: 15px;">
                        <button class="btn-danger" onclick="clearAllData()">
                            <i class="material-icons">delete_forever</i> Clear All Data
                        </button>
                        <button class="btn-warning" onclick="resetSystem()">
                            <i class="material-icons">restart_alt</i> Reset System
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('dynamicContent').innerHTML = content;
        }

        // ===== CHART FUNCTIONS =====
        function initDonationChart() {
            const ctx = document.getElementById('donationChart').getContext('2d');
            
            if (charts.donation) {
                charts.donation.destroy();
            }
            
            charts.donation = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                    datasets: [{
                        label: 'Donations ($)',
                        data: [1200, 1900, 1500, 2500, 2200, 3000, 2800],
                        borderColor: 'var(--primary)',
                        backgroundColor: 'rgba(26, 115, 232, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }

        function initAnalyticsCharts() {
            // Monthly Chart
            const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
            charts.monthly = new Chart(monthlyCtx, {
                type: 'bar',
                data: {
                    labels: ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar'],
                    datasets: [{
                        label: 'Donations',
                        data: [1800, 2200, 1900, 3100, 2800, 3500, dashboardData.stats.totalDonations / 4],
                        backgroundColor: 'rgba(26, 115, 232, 0.8)',
                        borderColor: 'var(--primary)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });

            // Method Chart
            const methodCtx = document.getElementById('methodChart').getContext('2d');
            charts.method = new Chart(methodCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Credit Card', 'PayPal', 'Bank Transfer', 'Mobile Money'],
                    datasets: [{
                        data: [45, 25, 20, 10],
                        backgroundColor: [
                            'var(--primary)',
                            'var(--secondary)',
                            'var(--warning)',
                            'var(--accent)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Location Chart
            const locationCtx = document.getElementById('locationChart').getContext('2d');
            charts.location = new Chart(locationCtx, {
                type: 'bar',
                data: {
                    labels: ['Nairobi', 'Mombasa', 'Kisumu', 'Nakuru', 'Eldoret'],
                    datasets: [{
                        label: 'Volunteers',
                        data: [15, 8, 6, 5, 4],
                        backgroundColor: 'rgba(52, 168, 83, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 2
                            }
                        }
                    }
                }
            });
        }

        // ===== UTILITY FUNCTIONS =====
        function getNotificationColor(type) {
            const colors = {
                'donation': 'var(--secondary)',
                'volunteer': 'var(--primary)',
                'project': 'var(--warning)',
                'system': 'var(--gray)'
            };
            return colors[type] || 'var(--primary)';
        }

        function getNotificationIcon(type) {
            const icons = {
                'donation': 'volunteer_activism',
                'volunteer': 'group',
                'project': 'construction',
                'system': 'info'
            };
            return icons[type] || 'notifications';
        }

        function updateNotificationBadges() {
            const unreadCount = dashboardData.notifications.filter(n => !n.read).length;
            document.getElementById('notificationCount').textContent = unreadCount;
            
            document.getElementById('overviewBadge').textContent = dashboardData.stats.pendingRequests;
            document.getElementById('donationBadge').textContent = dashboardData.stats.pendingDonations;
            document.getElementById('volunteerBadge').textContent = dashboardData.stats.pendingVolunteers;
        }

        function markAsRead(notificationId) {
            const notification = dashboardData.notifications.find(n => n.id === notificationId);
            if (notification) {
                notification.read = true;
                updateNotificationBadges();
                showToast('Notification marked as read', 'success');
                loadView(currentView);
            }
        }

        function showNotifications() {
            const notifications = dashboardData.notifications;
            const modalContent = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Notifications</h3>
                        <button class="modal-close" onclick="closeModal('notificationsModal')">
                            <i class="material-icons">close</i>
                        </button>
                    </div>
                    <div style="max-height: 400px; overflow-y: auto;">
                        ${notifications.map(notification => `
                            <div style="padding: 15px; border-bottom: 1px solid var(--light-gray); ${notification.read ? '' : 'background: rgba(26, 115, 232, 0.05);'}">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <i class="material-icons" style="color: ${getNotificationColor(notification.type)}; margin-top: 2px;">${getNotificationIcon(notification.type)}</i>
                                    <div style="flex: 1;">
                                        <div style="font-weight: ${notification.read ? '400' : '500'}; margin-bottom: 5px;">${notification.message}</div>
                                        <div style="font-size: 0.85rem; color: var(--gray);">${notification.time}</div>
                                    </div>
                                    ${!notification.read ? `
                                        <button class="btn-edit" onclick="markAsRead(${notification.id}); closeModal('notificationsModal')">Mark Read</button>
                                    ` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="padding: 15px; text-align: center; border-top: 1px solid var(--light-gray);">
                        <button class="btn-secondary" onclick="markAllAsRead()">
                            <i class="material-icons">done_all</i> Mark All as Read
                        </button>
                    </div>
                </div>
            `;
            
            showModal('notificationsModal', modalContent);
        }

        function markAllAsRead() {
            dashboardData.notifications.forEach(n => n.read = true);
            updateNotificationBadges();
            closeModal('notificationsModal');
            showToast('All notifications marked as read', 'success');
        }

        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const toastIcon = document.getElementById('toastIcon');
            const toastMessage = document.getElementById('toastMessage');
            
            toast.className = `toast ${type}`;
            toastMessage.textContent = message;
            
            const icons = {
                'success': 'check_circle',
                'error': 'error',
                'warning': 'warning',
                'info': 'info'
            };
            
            toastIcon.textContent = icons[type] || 'info';
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function showModal(modalId, content) {
            const existingModal = document.getElementById(modalId);
            if (existingModal) {
                existingModal.remove();
            }
            
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.id = modalId;
            modal.innerHTML = content;
            
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal(modalId);
                }
            });
            
            document.body.appendChild(modal);
            
            const escapeListener = function(e) {
                if (e.key === 'Escape') {
                    closeModal(modalId);
                    document.removeEventListener('keydown', escapeListener);
                }
            };
            
            document.addEventListener('keydown', escapeListener);
            
            modal.escapeListener = escapeListener;
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('show');
                
                if (modal.escapeListener) {
                    document.removeEventListener('keydown', modal.escapeListener);
                }
                
                setTimeout(() => {
                    if (modal.parentNode) {
                        modal.parentNode.removeChild(modal);
                    }
                }, 300);
            }
        }

        // ===== ACTION FUNCTIONS =====
        function editDonation(id) {
            const donation = dashboardData.donations.find(d => d.id === id);
            if (donation) {
                showToast(`Editing donation #${id} from ${donation.donor}`, 'info');
            }
        }

        function deleteDonation(id) {
            if (confirm('Are you sure you want to delete this donation record?')) {
                const index = dashboardData.donations.findIndex(d => d.id === id);
                if (index !== -1) {
                    dashboardData.donations.splice(index, 1);
                    showToast('Donation deleted successfully', 'success');
                    loadView('donations');
                }
            }
        }

        function editVolunteer(id) {
            const volunteer = dashboardData.volunteers.find(v => v.id === id);
            if (volunteer) {
                showToast(`Editing volunteer: ${volunteer.name}`, 'info');
            }
        }

        function deleteVolunteer(id) {
            if (confirm('Are you sure you want to remove this volunteer?')) {
                const index = dashboardData.volunteers.findIndex(v => v.id === id);
                if (index !== -1) {
                    dashboardData.volunteers.splice(index, 1);
                    showToast('Volunteer removed successfully', 'success');
                    loadView('volunteers');
                }
            }
        }

        function approveVolunteer(id) {
            const volunteer = dashboardData.volunteers.find(v => v.id === id);
            if (volunteer && volunteer.status === 'pending') {
                volunteer.status = 'active';
                showToast(`${volunteer.name} approved as volunteer`, 'success');
                loadView('volunteers');
            }
        }

        function editTeamMember(id) {
            const member = dashboardData.team.find(m => m.id === id);
            if (member) {
                showToast(`Editing team member: ${member.name}`, 'info');
            }
        }

        function deleteTeamMember(id) {
            if (confirm('Are you sure you want to remove this team member?')) {
                const index = dashboardData.team.findIndex(m => m.id === id);
                if (index !== -1) {
                    dashboardData.team.splice(index, 1);
                    showToast('Team member removed', 'success');
                    loadView('team');
                }
            }
        }

        function showAddDonationModal() {
            const content = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add New Donation</h3>
                        <button class="modal-close" onclick="closeModal('addDonationModal')">
                            <i class="material-icons">close</i>
                        </button>
                    </div>
                    <form id="addDonationForm" onsubmit="addNewDonation(event)">
                        <div class="form-group">
                            <label>Donor Name</label>
                            <input type="text" required placeholder="Enter donor name">
                        </div>
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" required placeholder="Enter donor email">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Amount ($)</label>
                                <input type="number" min="1" required placeholder="Enter amount">
                            </div>
                            <div class="form-group">
                                <label>Donation Type</label>
                                <select required>
                                    <option value="">Select type</option>
                                    <option value="one-time">One-time</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Payment Method</label>
                                <select required>
                                    <option value="">Select method</option>
                                    <option value="card">Credit Card</option>
                                    <option value="paypal">PayPal</option>
                                    <option value="bank">Bank Transfer</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select required>
                                    <option value="pending">Pending</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </div>
                        </div>
                        <div style="margin-top: 30px; display: flex; gap: 10px;">
                            <button type="submit" class="btn-primary">Add Donation</button>
                            <button type="button" class="btn-secondary" onclick="closeModal('addDonationModal')">Cancel</button>
                        </div>
                    </form>
                </div>
            `;
            
            showModal('addDonationModal', content);
        }

        function addNewDonation(e) {
            e.preventDefault();
            showToast('New donation added successfully', 'success');
            closeModal('addDonationModal');
            loadView('donations');
        }

        function showAddVolunteerModal() {
            showToast('Add volunteer feature coming soon!', 'info');
        }

        function showAddTeamModal() {
            showToast('Add team member feature coming soon!', 'info');
        }

        function manageContent(type) {
            showToast(`Managing ${type} content`, 'info');
        }

        function addNewPost() {
            showToast('New post feature coming soon!', 'info');
        }

        function filterGallery(filter) {
            showToast(`Filtering gallery: ${filter}`, 'info');
        }

        function showUploadModal() {
            showToast('Upload feature coming soon!', 'info');
        }

        function generateReport() {
            showToast('Generating report... Download will start soon.', 'info');
        }

        function printAnalytics() {
            window.print();
        }

        function clearAllData() {
            if (confirm('WARNING: This will delete ALL data. Are you absolutely sure?')) {
                showToast('Data cleared successfully', 'success');
            }
        }

        function resetSystem() {
            if (confirm('Reset all system settings to defaults?')) {
                showToast('System reset to defaults', 'success');
            }
        }

        function showProfileModal() {
            document.getElementById('profileModal').classList.add('show');
        }

        // ===== DASHBOARD CONTROLS =====
        document.getElementById('menuToggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            if (isSidebarOpen) {
                sidebar.style.transform = 'translateX(-100%)';
                mainContent.style.marginLeft = '0';
            } else {
                sidebar.style.transform = 'translateX(0)';
                mainContent.style.marginLeft = '250px';
            }
            
            isSidebarOpen = !isSidebarOpen;
        });

        function refreshDashboard() {
            showToast('Refreshing dashboard data...', 'info');
            setTimeout(() => {
                loadView(currentView);
                if (currentView === 'analytics') {
                    const newReport = aiAnalytics.generateReport();
                    showToast('Dashboard and AI analytics refreshed', 'success');
                } else {
                    showToast('Dashboard refreshed successfully', 'success');
                }
            }, 500);
        }

        function filterByDate() {
            const date = document.getElementById('dateFilter').value;
            if (date) {
                showToast(`Filtering by date: ${date}`, 'info');
            }
        }

        // ===== EVENT LISTENERS =====
        document.getElementById('logoutBtn').addEventListener('click', function(e) {
            e.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                document.getElementById('dashboardMain').style.display = 'none';
                document.getElementById('loginScreen').style.display = 'flex';
                document.getElementById('password').value = '';
                showToast('Logged out successfully', 'info');
            }
        });

        document.getElementById('profileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            closeModal('profileModal');
            showToast('Profile updated successfully', 'success');
        });

        // Close modal on outside click
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('show');
                }
            });
        });

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            // Set default date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dateFilter').value = today;
            
            // Check for saved login (demo only)
            const savedLogin = localStorage.getItem('demoLoggedIn');
            if (savedLogin === 'true') {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboardMain').style.display = 'block';
                loadView('overview');
                updateNotificationBadges();
            }
            
            // Save demo login state
            localStorage.setItem('demoLoggedIn', 'true');
        });

        // Handle window resize for responsive sidebar
        window.addEventListener('resize', function() {
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('mainContent');
                sidebar.style.transform = 'translateX(-100%)';
                mainContent.style.marginLeft = '0';
                isSidebarOpen = false;
            } else {
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('mainContent');
                sidebar.style.transform = 'translateX(0)';
                mainContent.style.marginLeft = '250px';
                isSidebarOpen = true;
            }
        });
    </script>
</body>
</html>